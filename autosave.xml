<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE muclient>
<!-- Saved on Monday, June 14, 2021, 11:32 AM -->
<!-- MuClient version 5.07-pre -->

<!-- Plugin "autosave" generated by Plugin Wizard -->

<muclient>
<plugin
   name="autosave"
   author="Naricain"
   id="9d256e3fdb93859478db469d"
   language="Lua"
   purpose="Autosave the world file when there are any changes"
   save_state="y"
   date_written="2021-06-14 11:31:18"
   requires="5.00"
   version="1.0"
   >

</plugin>
<timers>
  <timer enabled="y" second="1.00" offset_second="0.00" send_to="12" script="do_autosave" />
</timers>
<aliases>
  <alias
    match="^autosave (on|off|show*)$"
    script="autosave_toggle"
    regexp="y"
    ignore_case="y"
    enabled="y"
  >
  </alias>
  <alias
    match="^autosave interval ([0-9]+)$"
    script="autosave_interval"
    regexp="y"
    ignore_case="y"
    enabled="y"
  >
  </alias>
</aliases>
<script>
<![CDATA[
  local last_save = os.clock()
  local AUTOSAVE_INTERVAL = 60 * 10 -- 10 minutes apart
  local autoSave = GetVariable("autoSave") or "on"

  function do_autosave()
    if GetInfo(111) or last_save + AUTOSAVE_INTERVAL < os.clock() then
      if(autoSave == "on") then
        Save()
        ColourNote("white", "blue", "World file saved.")
        last_save = os.clock()
      end
    end
  end

	function autosave_toggle(name, line, wildcards)
		if (not wildcards[1] or wildcards[1] == "" or wildcards[1] == "show") then
			ColourNote("white", "blue","Autosave currently set to: '"..autoSave.. "'")
		else
			autoSave = wildcards[1]:lower()
			SetVariable("autoSave", autoSave)
			ColourNote("white", "blue","Autosave is now set to: '".. autoSave.. "'")
		end
	end
  
  function autosave_interval(name, line, wildcards)
    AUTOSAVE_INTERVAL = 60 * tonumber(Trim(wildcards[1])) or 60 * 10
    ColourNote("white", "blue","Autosave interval set to: ".. AUTOSAVE_INTERVAL.. " seconds.")
  end
]]>
</script>


</muclient>
